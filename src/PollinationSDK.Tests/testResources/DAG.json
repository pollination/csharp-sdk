 {
    "name": "main",
    "inputs": {
        "parameters": [
            {
                "annotations": {
                    "type": "number"
                },
                "name": "north",
                "default": "0",
                "description": "A number for rotation from north.",
                "required": null
            },
            {
                "annotations": {
                    "type": "string"
                },
                "name": "radiance-parameters",
                "default": "-ab 2",
                "description": "The radiance parameters for ray tracing. The value for ambient bounces will be set to 0 and 1 for direct sunlight and direct sky steps.",
                "required": null
            },
            {
                "annotations": {
                    "type": "integer"
                },
                "name": "sensor-count",
                "default": "200",
                "description": "The maximum number of grid points per parallel execution",
                "required": null
            },
            {
                "annotations": {
                    "type": "array",
                    "items": "string"
                },
                "name": "sensor-grids",
                "default": null,
                "description": "A list of input grid names (e.g. room). These grids must be available under\nmodel/grids folder.\n",
                "required": true
            }
        ],
        "artifacts": [
            {
                "annotations": {
                    "type": "folder"
                },
                "name": "model",
                "description": "Radiance model folder.",
                "default": null,
                "required": true
            },
            {
                "annotations": {
                    "type": "file",
                    "extension": "wea"
                },
                "name": "wea",
                "description": "Wea file.",
                "default": null,
                "required": true
            }
        ]
    },
    "fail_fast": true,
    "tasks": [
        {
            "name": "aggregate-results",
            "template": "honeybee-radiance/merge-files",
            "arguments": {
                "parameters": [
                    {
                        "name": "extension",
                        "from": null,
                        "value": ".ill"
                    },
                    {
                        "name": "name",
                        "from": null,
                        "value": "grid"
                    }
                ],
                "artifacts": [
                    {
                        "name": "results-folder",
                        "from": {
                            "type": "folder",
                            "path": "initial_results/{{item}}/final"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": [
                "annual-daylight-simulation"
            ],
            "loop": {
                "from": {
                    "type": "inputs",
                    "variable": "sensor-grids"
                },
                "value": null
            },
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "result-file",
                        "path": "results/{{item}}.ill"
                    }
                ]
            }
        },
        {
            "name": "annual-daylight-simulation",
            "template": "annual-daylight-entry",
            "arguments": {
                "parameters": [
                    {
                        "name": "radiance-parameters",
                        "from": {
                            "type": "inputs",
                            "variable": "radiance-parameters"
                        },
                        "value": null
                    },
                    {
                        "name": "sensor-count",
                        "from": {
                            "type": "inputs",
                            "variable": "sensor-count"
                        },
                        "value": null
                    }
                ],
                "artifacts": [
                    {
                        "name": "octree-file",
                        "from": {
                            "type": "tasks",
                            "name": "create-octree",
                            "variable": "scene-file"
                        },
                        "subpath": null
                    },
                    {
                        "name": "sensor-grid",
                        "from": {
                            "type": "inputs",
                            "variable": "model"
                        },
                        "subpath": "grid/{{item}}.pts"
                    },
                    {
                        "name": "sky-dome",
                        "from": {
                            "type": "tasks",
                            "name": "create-sky-dome",
                            "variable": "sky-dome"
                        },
                        "subpath": null
                    },
                    {
                        "name": "sky-matrix",
                        "from": {
                            "type": "tasks",
                            "name": "create-total-sky",
                            "variable": "sky-matrix"
                        },
                        "subpath": null
                    },
                    {
                        "name": "sky-matrix-direct",
                        "from": {
                            "type": "tasks",
                            "name": "create-direct-sky",
                            "variable": "sky-matrix"
                        },
                        "subpath": null
                    },
                    {
                        "name": "sun-modifiers",
                        "from": {
                            "type": "tasks",
                            "name": "create-sunpath",
                            "variable": "sun-modifiers"
                        },
                        "subpath": null
                    },
                    {
                        "name": "sunpath",
                        "from": {
                            "type": "tasks",
                            "name": "create-sunpath",
                            "variable": "sunpath"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": [
                "create-sky-dome",
                "create-octree",
                "create-sunpath",
                "create-total-sky",
                "create-direct-sky"
            ],
            "loop": {
                "from": {
                    "type": "inputs",
                    "variable": "sensor-grids"
                },
                "value": null
            },
            "sub_folder": "initial_results/{{item}}",
            "outputs": {
                "parameters": [],
                "artifacts": []
            }
        },
        {
            "name": "create-direct-sky",
            "template": "honeybee-radiance/create-sky-matrix",
            "arguments": {
                "parameters": [
                    {
                        "name": "north",
                        "from": {
                            "type": "inputs",
                            "variable": "north"
                        },
                        "value": null
                    },
                    {
                        "name": "sky-component",
                        "from": null,
                        "value": "-d"
                    }
                ],
                "artifacts": [
                    {
                        "name": "wea",
                        "from": {
                            "type": "inputs",
                            "variable": "wea"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": null,
            "loop": null,
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "sky-matrix",
                        "path": "resources/sky_direct.mtx"
                    }
                ]
            }
        },
        {
            "name": "create-octree",
            "template": "honeybee-radiance/create-octree-with-sky",
            "arguments": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "model",
                        "from": {
                            "type": "inputs",
                            "variable": "model"
                        },
                        "subpath": null
                    },
                    {
                        "name": "sky",
                        "from": {
                            "type": "tasks",
                            "name": "create-sunpath",
                            "variable": "sunpath"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": [
                "create-sunpath"
            ],
            "loop": null,
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "scene-file",
                        "path": "resources/scene.oct"
                    }
                ]
            }
        },
        {
            "name": "create-sky-dome",
            "template": "honeybee-radiance/create-sky-dome",
            "arguments": {
                "parameters": [],
                "artifacts": []
            },
            "dependencies": null,
            "loop": null,
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "sky-dome",
                        "path": "resources/sky.dome"
                    }
                ]
            }
        },
        {
            "name": "create-sunpath",
            "template": "honeybee-radiance/create-sun-matrix",
            "arguments": {
                "parameters": [
                    {
                        "name": "north",
                        "from": {
                            "type": "inputs",
                            "variable": "north"
                        },
                        "value": null
                    }
                ],
                "artifacts": [
                    {
                        "name": "wea",
                        "from": {
                            "type": "inputs",
                            "variable": "wea"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": null,
            "loop": null,
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "sun-modifiers",
                        "path": "resources/suns.mod"
                    },
                    {
                        "name": "sunpath",
                        "path": "resources/sunpath.mtx"
                    }
                ]
            }
        },
        {
            "name": "create-total-sky",
            "template": "honeybee-radiance/create-sky-matrix",
            "arguments": {
                "parameters": [
                    {
                        "name": "north",
                        "from": {
                            "type": "inputs",
                            "variable": "north"
                        },
                        "value": null
                    }
                ],
                "artifacts": [
                    {
                        "name": "wea",
                        "from": {
                            "type": "inputs",
                            "variable": "wea"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": null,
            "loop": null,
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "sky-matrix",
                        "path": "resources/sky.mtx"
                    }
                ]
            }
        },
        {
            "name": "parse-sun-up-hours",
            "template": "honeybee-radiance/parse-sun-up-hours",
            "arguments": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "sun-modifiers",
                        "from": {
                            "type": "tasks",
                            "name": "create-sunpath",
                            "variable": "sun-modifiers"
                        },
                        "subpath": null
                    }
                ]
            },
            "dependencies": [
                "create-sunpath"
            ],
            "loop": null,
            "sub_folder": null,
            "outputs": {
                "parameters": [],
                "artifacts": [
                    {
                        "name": "sun-up-hours",
                        "path": "results/sun-up-hours.txt"
                    }
                ]
            }
        }
    ],
    
}